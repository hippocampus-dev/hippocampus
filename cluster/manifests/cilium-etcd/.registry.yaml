name: cilium-etcd
namespace: kube-system
components:
  - name: cilium-etcd-0
    workloadType: statefulset
    labels:
      app.kubernetes.io/component: etcd
      app.kubernetes.io/instance: cilium-etcd-0
      app.kubernetes.io/name: cilium
    logs:
      grouping: kubernetes.kube-system.cilium-etcd
      link: https://grafana.minikube.127.0.0.1.nip.io/explore?schemaVersion=1&panes=%7B%22default%22%3A%7B%22datasource%22%3A%22loki%22%2C%22queries%22%3A%5B%7B%22expr%22%3A%22%7Bgrouping%3D%5C%22kubernetes.kube-system.cilium-etcd%5C%22%7D%22%7D%5D%7D%7D
    metrics:
      link: https://grafana.minikube.127.0.0.1.nip.io/d/workload/workload?orgId=1&var-namespace=kube-system&var-workload_type=statefulset&var-workload=cilium-etcd-0
      labelSets:
        - labels:
            namespace: kube-system
            workload: cilium-etcd-0
            workload_type: statefulset
          queries:
            - name: CPU Usage
              template: sum by (pod) (rate(container_cpu_usage_seconds_total{container!=""}[5m]) * on(namespace,pod) group_left() mixin_pod_workload{<<.LabelMatchers>>})
            - name: CPU Throttled
              template: sum by (pod) (rate(container_cpu_cfs_throttled_periods_total{container!=""}[5m]) * on(namespace,pod) group_left() mixin_pod_workload{<<.LabelMatchers>>}) / sum by (pod) (rate(container_cpu_cfs_periods_total{container!=""}[5m]) * on(namespace,pod) group_left() mixin_pod_workload{<<.LabelMatchers>>})
            - name: Memory Working Set
              template: sum by (pod) (container_memory_working_set_bytes{container!=""} * on(namespace,pod) group_left() mixin_pod_workload{<<.LabelMatchers>>})
        - labels:
            app_kubernetes_io_component: etcd
            app_kubernetes_io_name: cilium
            namespace: kube-system
