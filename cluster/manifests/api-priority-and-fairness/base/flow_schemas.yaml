apiVersion: flowcontrol.apiserver.k8s.io/v1
kind: FlowSchema
metadata:
  name: health-for-strangers
spec:
  matchingPrecedence: 1000
  priorityLevelConfiguration:
    name: exempt
  rules:
    - nonResourceRules:
      - nonResourceURLs:
          - "/healthz"
          - "/livez"
          - "/readyz"
        verbs:
          - "*"
      subjects:
        - kind: Group
          group:
            name: "system:unauthenticated"
---
apiVersion: flowcontrol.apiserver.k8s.io/v1
kind: FlowSchema
metadata:
  name: vpa
spec:
  matchingPrecedence: 1000
  priorityLevelConfiguration:
    name: workload-high
  rules:
    - resourceRules:
        - apiGroups:
            - "*"
          clusterScope: true
          namespaces:
            - "*"
          resources:
            - "*"
          verbs:
            - "*"
      nonResourceRules:
        - nonResourceURLs:
            - "*"
          verbs:
            - "*"
      subjects:
        - kind: ServiceAccount
          serviceAccount:
            name: "*"
            namespace: vpa
