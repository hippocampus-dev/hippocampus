#!/usr/bin/env bash

set -eo pipefail

function install_version() {
  local install_type="${1}"
  local version="${2}"
  local install_path="${3%/bin}/bin"

  if [ "${install_type}" != "version" ]; then
    echo -e "asdf-hippocampus: asdf-hippocampus supports release installs only" >&2
    exit 1
  fi

  mkdir -p "${install_path}"

  if [ -z "$(ls -A "${ASDF_DOWNLOAD_PATH}" 2>/dev/null)" ]; then
    echo -e "asdf-hippocampus: No files downloaded. Check download errors above." >&2
    exit 1
  fi

  cp -r "${ASDF_DOWNLOAD_PATH}"/* "${install_path}"

  echo "hippocampus ${version} installation was successful!"
}

install_version "${ASDF_INSTALL_TYPE}" "${ASDF_INSTALL_VERSION}" "${ASDF_INSTALL_PATH}"
